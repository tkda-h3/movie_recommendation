# Matirx Factorization
## 前置き
### 次元の呪い
ユーザの各映画に対する評価を要素とするベクトルを用意する。評価していない映画の評価は０とする。
評価の似ているユーザ同士はどの映画も同様の評価をするという仮定のもと、ユーザのベクトルの近さをコサイン類似度などを計算することで求める手法において、映画の種類数が膨大になると次元の呪いに陥ってしまう問題が発生する。

そこで次元削減を行い効率よく学習するアルゴリズムとしてMatrix Factorizationが有用である。

## アルゴリズム概要
Matirx Factorizationはユーザのおすすめ映画レコメンドシステムに有用なアルゴリズムの１つである。


### 次元削減
m人のユーザとn個の映画を考えた時、ユーザの映画に対する５段階評価を$m\times n$の行列Rとする。
$R \approx P \times Q$となるような行列$P,Q$を求めたい。$P,Q$はそれぞれ$m\times k, k \times n(m,n>k)$次元である。

kがm,nより小さいために次元削減が可能となる。

### バイアスの付与
ただし各ユーザの映画に対する評価値が相対的に高いのか低いのか、また各映画の評価値が相対的に高いのか低いのかということを考慮できていないため、次のような改良を施す。

$R_{ui} \approx P_{u*} \times Q_{*i} + \mu + b_u + b_i $

$\mu$ : 全ユーザの全映画にたいする評価値の平均

$b_u$ : ユーザuの映画に対する評価値の平均 $- \mu$

$b_i$ : 映画iの評価値の平均 $- \mu$


### 学習
ここで以下の誤差関数を最小化するように学習を行う。

$$ \min_{P,Q,b_u,b_i} \sum_{(u,i) \in R} (R_{ui} - P_{u*} Q_{*i} - \mu - b_u - b_i)^{2} + \lambda (\|P\|^{2} + \|Q\|^{2}  + b^{2}_u + b^{2}_i)$$

右項は正則化項である。
今回の実装では学習アルゴリズムは確率的勾配降下法の一種であるSGDを用いた。


## 実装コード
[recommend_movie.ipynb](https://github.com/tkda-h3/movie_recommendation/blob/master/recommend_movie.ipynb)をGitHubに公開している。

## 実装手法の改善点
- alphaやlambdaやlatent_dimなどのハイパーパラメータの最適化
  * 決め打ちで定数にしているので精度の高い結果を得られるパラメータをテストに採用する
- 各ユーザの映画の鑑賞履歴などのデータの活用
  * 映画の評価値以外にもユーザの好みが反映されるデータをバイアスとして利用する



